<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BingMaps Library</title>
    <style>html,body{height:100%;}body{padding:0;margin:0;}h1{padding:0;margin:0;font-size:50%;}#direction{width: 30%;float: left;display: block;}</style>
</head>
<body>

<!--AutoSuggest[START]-->
<h1>AutoSuggest（Enter city in text box）</h1>
<div id="searchBoxContainer">
    <input type="text" id="searchBox"><button id="clear">Clear</button>
</div>
<!--AutoSuggest[END]-->

<!--Directions[START]-->
<div>From:<input type="text" id="from"> To:<input id="to"><input type="button" id="search" value="Search"> </div>
<div id="direction"></div>
<!-- Directions[END] -->

<!-- MAP[START] -->
<div id="geocode">geocode:data</div>
<div id="myMap" style='width:60%;height:70%;float:left;'></div>
<!-- MAP[END] -->




<script src='https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=Arpy7tq1krdMikodQT8fpJhY631dPSwVFkZhGo5sUW5yAEClXNrp-vk71Ee6dMAI&setLang=en&setMkt=en-US' async defer></script>
<script src="js/BmapQuery.js"></script>
<script>
//****************************************************************************************
// BingMaps&BmapQuery
//****************************************************************************************
//Init
function GetMap(){
    //------------------------------------------------------------------------
    //Instance
    //------------------------------------------------------------------------
    const map = new Bmap("#myMap");
    
    //------------------------------------------------------------------------
    //Map:Init
    //------------------------------------------------------------------------
    map.startMap(47.6149, -122.1941, "load", 16);

    //------------------------------------------------------------------------
    //Map:Event
    //------------------------------------------------------------------------
    map.onMap("click",function(){
        alert("MapEvent!");
    });
    
    //------------------------------------------------------------------------
    //Pushpin
    //------------------------------------------------------------------------
    const pin1 = map.pin(47.6149, -122.1941, "#ff0000");
    //------------------------------------------------------------------------
    //pushpin:Event
    //------------------------------------------------------------------------
    map.onPin(pin1, "click", function(){
        alert("PinEvent1");
    });
    
    //------------------------------------------------------------------------
    //Pushpin:Text
    //------------------------------------------------------------------------
    const pin2 = map.pinText(47.6160, -122.1950, "title","subtitle","A");
    
    //------------------------------------------------------------------------
    //Pushpin:Icon
    //------------------------------------------------------------------------
    const pin3 = map.pinIcon(47.6130, -122.1945, "img/poi_custom.png", 1.0, 0, 0);
    
    //------------------------------------------------------------------------
    //Infobox
    //------------------------------------------------------------------------
    map.infobox(47.6149, -122.1941, "1 step", "Start");
    
    //------------------------------------------------------------------------
    //Infobox:html
    //------------------------------------------------------------------------
    const html = '<div style="background:red;">Hello,world</div>';
    map.infoboxHtml(47.6160, -122.1950, html);
    
    //------------------------------------------------------------------------
    //MapViewChange
    //after 2 seconds.
    //------------------------------------------------------------------------
    setTimeout(function(){
        map.changeMap(47.6150, -122.1950, "load", 17);
    },2000);

    //------------------------------------------------------------------------
    //GeocodeJson
    //after 4 seconds.
    //------------------------------------------------------------------------
    setTimeout(function () {
        map.getGeocode("Seattle", function(data){
            //checkCode: variable data.
            alert("getGeocode");
            document.querySelector("#geocode").innerHTML=data;
        });
    },4000);
    
    //------------------------------------------------------------------------
    //ReverseGeocodeJson
    //after 6 seconds.
    //------------------------------------------------------------------------
    setTimeout(function () {
        map.reverseGeocode("Seattle", function(data){
            //checkCode: variable data.
            alert("ReverseGeocode");
            document.querySelector("#geocode").innerHTML=data;
        });
    },6000);
    
    //------------------------------------------------------------------------
    //Directions:Search.
    // !! For confirmation, set the parameters for each country !!
    // +  [ English => https://www.bing.com/...&setLang=en&setMkt=en-US ]
    // +  [ Japan   => https://www.bing.com/...&setLang=ja&setMkt=ja-JP ]
    //------------------------------------------------------------------------
    document.getElementById("search").onclick = function () {
        const from  = document.getElementById("from").value;  //StartPoint
        const to    = document.getElementById("to").value;    //EndPoint
        const array = ["Bellevue", "Yarrow Point"];           //Waypoints...
        map.direction("#direction", from , to, array);        //Direction Methed
    };
    
    //------------------------------------------------------------------------
    // AutoSuggest
    // ** !! Only viewing user's region can be displayed !!
    //------------------------------------------------------------------------
    // HTML:Add !!
    //<h1>AutoSuggest（Enter city in text box）</h1>
    //<div id='searchBoxContainer'>
    //    <input type='text' id='searchBox'><button id="clear">Clear</button>
    //</div>
    //------------------------------------------------------------------------
    map.selectedSuggestion("#searchBox","#searchBoxContainer");

}
 
    
</script>


</body>
</html>